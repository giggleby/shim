board: CHROMEBOOK

encoding_patterns:
  0: default
  1: new pattern

image_id:
  0: EVT
  1: DVT
  2: MP
  3: FOO
  4: BAR
  5: BUZ

pattern:
  - firmware: 5             # 5 bits

  - audio_codec: 1
  - battery: 2
  - bluetooth: 0
  - camera: 0
  - cellular: 1
  - chipset: 0
  - cpu: 1                  # 10 bits

  - display_panel: 0
  - dram: 1
  - keyboard: 1
  - cpu: 1
  - storage: 2              # 15 bits

  - cpu: 1                  # 16 bits

encoded_fields:
  audio_codec:
    0:
      audio_codec: [codec_0, hdmi_0]
    1:
      audio_codec: [codec_1, hdmi_1]
  battery:
    0:
      battery: battery_small
    1:
      battery: battery_medium
    2:
      battery: battery_large
    3:
      battery: battery_huge
  bluetooth:
    0:
      bluetooth: bluetooth_0
  camera:
    0:
      camera: camera_0
  cellular:
    0:
      cellular: NULL
    1:
      cellular: cellular_0
  chipset:
    0:
      chipset: chipset_0
  cpu:
    0:
      cpu: cpu_0
    1:
      cpu: cpu_1
    2:
      cpu: cpu_2
    3:
      cpu: cpu_3
    4:
      cpu: cpu_4
    5:
      cpu: cpu_5
  display_panel:
    0:
      display_panel: display_panel_0
  dram:
    0:
      dram: dram_0
    1:
      dram: dram_1
  ec_flash_chip:
    0:
      ec_flash_chip: ec_flash_chip_0
  embedded_controller:
    0:
      embedded_controller: embedded_controller_0
  flash_chip:
    0:
      flash_chip: flash_chip_0
  keyboard:
    0:
      keyboard: keyboard_us
    1:
      keyboard: keyboard_gb
  storage:
    0:
      storage: storage_0
    1:
      storage: storage_1
    2:
      storage: storage_2
  firmware:
    0:
      hash_gbb: hash_gbb_0
      key_recovery: key_recovery_0
      key_root: key_root_0
      ro_ec_firmware: ro_ec_firmware_0
      ro_main_firmware: ro_main_firmware_0
    1:
      hash_gbb: hash_gbb_0
      key_recovery: key_recovery_0
      key_root: key_root_0
      ro_ec_firmware: ro_ec_firmware_0
      ro_main_firmware: ro_main_firmware_1

components:
  audio_codec:
    items:
      codec_0:
        value: Codec 0

      codec_1:
        value: Codec 1

      hdmi_0:
        value: HDMI 0

      hdmi_1:
        value: HDMI 1

  battery:
    items:
      battery_small:
        value: Battery Li-ion 2500000

      battery_medium:
        value: Battery Li-ion 5000000

      battery_large:
        value: Battery Li-ion 7500000

      battery_huge:
        value: Battery Li-ion 10000000

  bluetooth:
    items:
      bluetooth_0:
        value: 0123:abcd 0001

  camera:
    items:
      camera_0:
        value: 4567:abcd Camera

  cellular:
    items:
      cellular_0:
        value: 89ab:abcd Cellular Card

  chipset:
    items:
      chipset_0:
        value: cdef:abcd

  cpu:
    items:
      cpu_0:
        value: CPU @ 1.80GHz [4 cores]

      cpu_1:
        value: CPU @ 2.00GHz [4 cores]

      cpu_2:
        value: CPU @ 2.20GHz [4 cores]

      cpu_3:
        value: CPU @ 2.40GHz [4 cores]

      cpu_4:
        value: CPU @ 2.60GHz [4 cores]

      cpu_5:
        value: CPU @ 2.80GHz [4 cores]

  display_panel:
    probeable: False
    items:
      display_panel_0:
        value: FOO:0123 [1440x900]

  dram:
    items:
      dram_0:
        value: DRAM 4G

      dram_1:
        value: DRAM 4G

  ec_flash_chip:
    items:
      ec_flash_chip_0:
        value: EC Flash Chip

  embedded_controller:
    items:
      embedded_controller_0:
        value: Embedded Controller

  flash_chip:
    items:
      flash_chip_0:
        value: Flash Chip

  keyboard:
    probeable: False
    items:
      keyboard_gb:
        value: xkb:gb:extd:eng
        labels: [GB]

      keyboard_us:
        value: xkb:us::eng
        labels: [US]

  storage:
    items:
      storage_0:
        value: '16G SSD #123456'
        labels: [SSD, 16G]

      storage_1:
        value: '32G SSD #123456'
        labels: [SSD, 32G]

      storage_2:
        value: '500G HDD #123456'
        labels: [HDD, 500G]

  hash_gbb:
    items:
      hash_gbb_0:
        value: gv2#hash_gbb_0

  key_recovery:
    items:
      key_recovery_0:
        value: kv3#key_recovery_0

  key_root:
    items:
      key_root_0:
        value: kv3#key_root_0

  ro_ec_firmware:
    items:
      ro_ec_firmware_0:
        value: ev2#ro_ec_firmware_0

  ro_main_firmware:
    items:
      ro_main_firmware_0:
        value: mv2#ro_main_firmware_0
      ro_main_firmware_1:
        value: mv2#ro_main_firmware_1

shopfloor_device_info:
  component.has_cellular:
    True:
      cellular: cellular_0
    False:
      cellular: NULL
  component.keyboard:
    us:
      keyboard: keyboard_us
    gb:
      keyboard: keyboard_gb
  component.dram:
    foo:
      dram: dram_0
    bar:
      dram: dram_1
  component.audio_codec:
    set_0:
      audio_codec: [codec_0, hdmi_0]
    set_1:
      audio_codec: [codec_1, hdmi_1]

vpd_ro_fields:
- initial_locale
- initial_timezone
- keyboard_layout
- serial_number

vpd_rw_fields:
- gbind_attribute
- ubind_attribute

rules:
  - name: Test rule 1
    when:
      - audio_codec EQ Codec 1
      - audio_codec EQ HDMI 1
    check_all:
      - battery EQ battery_huge
      - hash_gbb EQ hash_gbb_0
      - key_recovery EQ key_recovery_0
      - key_root EQ key_root_0
      - ro_ec_firmware EQ ro_ec_firmware_0
      - ro_main_firmware EQ ro_main_firmware_0

  - name: Test rule 2
    when:
      - dram EQ dram_0
    check_all:
      - battery EQ battery_huge
      - hash_gbb EQ hash_gbb_0
      - key_recovery EQ key_recovery_0
      - key_root EQ key_root_0
      - ro_ec_firmware EQ ro_ec_firmware_0
      - ro_main_firmware EQ ro_main_firmware_0
      - cpu IN (cpu_1, cpu_2)

  - name: Test rule 3
    when:
      - dram EQ dram_0
      - cellular EQ cellular_0
    check_all:
      - battery EQ huge_battery
      - cpu IN (cpu_1, cpu_2)

  - name: Test rule 4
    when:
      - cpu IN *
    check_all:
      - storage EQ SSD
      - storage EQ 16G
      - check_any:
          - battery NE battery_small
          - cpu IN (cpu_1, cpu_2, cpu_3)

  - name: Test rule 5
    when:
      - cpu IN *
    check_any:
      - storage EQ SSD
      - storate EQ 16G

  - name: Test rule 6
    when:
      - '*'
    check_any:
      - storage EQ SSD
      - storate EQ 16G

allowed_skus:
  - name: SKU1
    check_all:
      - audio_codec EQ codec_1
      - audio_codec EQ hdmi_1
      - cpu EQ cpu_5
      - battery EQ battery_huge
      - keyboard EQ US
      - storage EQ SSD
      - storage EQ 16G

  - name: SKU2
    check_all:
      - audio_codec EQ codec_1
      - audio_codec EQ hdmi_1
      - cpu EQ cpu_4
      - battery EQ battery_medium
      - keyboard EQ GB
      - storage EQ HDD
      - storage EQ 500G

  - name: SKU3
    check_all:
      - audio_codec IN *
      - cpu IN *
      - battery IN *
      - keyboard IN *
      - storage IN *
