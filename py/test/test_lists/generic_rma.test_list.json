{
  "label": "Generic RMA",
  "inherit": [
    "disable_factory_server.test_list",
    "generic_grt.test_list"
  ],
  "constants": {
    "phase": "PVT",
    "rma_mode": true
  },
  "definitions": {
    "RMAFFT": {
      "label": "FFT",
      "inherit": "TestGroup",
      "subtests": [
        "Placeholder"
      ]
    },
    "RMAGRT": {
      "inherit": "TestGroup",
      "label": "GRT (Google Required Tests)",
      "locals": {
        "station_end_upload_report": true,
        "station": "GRT"
      },
      "subtests": [
        "WriteHWID",
        "RMACr50Reset",
        "RMAGRTEnd",
        "AllCheckPoint",
        "RMAGRTFinalize"
      ]
    },
    "RMACr50Reset": {
      "label": "Cr50 RMA Cleanup",
      "inherit": "TestGroup",
      "subtests": [{
          "inherit": "ExecShell",
          "label": "Clear RMA Unlock State",
          "args": {
            "commands": "gooftool cr50_disable_rma_mode"
          }
        }]
    },
    "RMAGRTEnd": {
      "inherit": "TestGroup",
      "label": "Finish",
      "subtests": [
        "TPMVerifyEK",
        "ClearTPMOwnerRequest",
        "Barrier",
        "RebootStep"
      ]
    },
    "RMAGRTFinalize": {
      "inherit": "GRTFinalize",
      "args": {
        "rma_mode": true,
        "enable_factory_server": false,
        "upload_method": "none",
        "write_protection": "eval! constants.force_write_protect or options.phase == 'PVT'"
      }
    }
  },
  "tests": [
    "RMAFFT",
    "RMAGRT"
  ]
}
