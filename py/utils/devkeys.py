# Copyright 2023 The ChromiumOS Authors
# Use of this source code is governed by a BSD-style license that can be
# found in the LICENSE file.
"""Verified boot signing keys from platform/vboot_reference/tests/devkeys/."""

import base64
import contextlib
import tempfile


class KeyStore:
  """A storage for Base64 encoded key objects."""

  def __init__(self, s):
    self.key_b64 = s

  def Blob(self):
    """Returns the raw blob (bytes) of the stored key."""
    return base64.b64decode(self.key_b64)

  @contextlib.contextmanager
  def TempFile(self):
    """Returns the name of a temporary file that has the key blob."""
    with tempfile.NamedTemporaryFile('wb') as f:
      f.write(self.Blob())
      f.flush()
      yield f.name


RECOVERY_KERNEL_KEYBLOCK = KeyStore('''
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
+nRPYrOLkw==
''')

RECOVERY_KERNEL_DATA_KEY_VBPRIVK = KeyStore('''
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
''')


def ResignRecoveryKernel(shell, futility, kernel):
  """Resigns a kernel blob file using the recovery keys.

  Args:
    shell: A function to invoke the shell command.
    futility: The path to the futility program for signing.
    kernel: A file containing the kernel blob. Can be a block device file.

  Returns:
    The result from the shell command invocation.
  """
  with RECOVERY_KERNEL_DATA_KEY_VBPRIVK.TempFile() as private_key:
    with RECOVERY_KERNEL_KEYBLOCK.TempFile() as key_block:
      return shell([
          futility, 'vbutil_kernel', '--repack', kernel, '--oldblob', kernel,
          '--keyblock', key_block, '--signprivate', private_key
      ])
